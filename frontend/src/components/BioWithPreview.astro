---
import PlyrPreview from "./PlyrPreview.astro"
import { getBioWithPreview } from "../lib/sanity.queries"

const doc = await getBioWithPreview()

const DEFAULT_BIO = `I SHOOT CLEAN, CINEMATIC VIDEO FOR BRANDS AND PEOPLE WHO CARE ABOUT CRAFT.
FAST TURNAROUND, CALM SETS, SHARP EDITS. COMMERCIALS, SOCIAL CUTS, EVENT RECAPS,
AND STORY-DRIVEN PIECES â€” DONE PROPERLY.`

const DEFAULT_MP4 =
  "https://res.cloudinary.com/hardcodepunk/video/upload/q_auto:eco,vc_h264,ac_aac,f_mp4/v1737957147/wsuszohtmu2pks673muc.mp4"
const DEFAULT_WEBM =
  "https://res.cloudinary.com/hardcodepunk/video/upload/q_auto:eco,vc_vp9,f_webm/v1761381373/b8f7chk3u9s6jaqh4bae.webm"
const DEFAULT_POSTER =
  "https://res.cloudinary.com/hardcodepunk/video/upload/q_auto:eco,so_0,f_jpg,w_1600/v1737957147/wsuszohtmu2pks673muc.jpg"

const props = Astro.props as {
  bio?: string
  mp4?: string
  webm?: string
  poster?: string
}

const bio = props.bio ?? doc?.bio ?? DEFAULT_BIO
const mp4 = props.mp4 ?? doc?.previewVideo?.mp4 ?? DEFAULT_MP4
const webm = props.webm ?? doc?.previewVideo?.webm ?? DEFAULT_WEBM
const poster = props.poster ?? doc?.previewVideo?.poster ?? DEFAULT_POSTER
---

<section class="bp">
  <div class="bp-inner">
    <div class="bp-left">
      <p class="bp-bio">{bio}</p>
    </div>

    <div class="bp-right">
      <PlyrPreview mp4={mp4} webm={webm} poster={poster} />
    </div>
  </div>

  <style>
    .bp {
      padding: 72px 0;
    }
    .bp-inner {
      max-width: 72rem;
      margin: 0 auto;
      padding: 0 1rem;
      display: grid;
      grid-template-columns: 1.15fr 0.85fr;
      gap: 48px;
      align-items: center;
    }
    .bp-bio {
      margin: 0;
      font-family: var(--font-display, "Bebas Neue", sans-serif);
      font-size: clamp(2.1rem, 4vw, 3.2rem);
      line-height: 1.05;
      letter-spacing: 0.02em;
      color: rgba(255, 255, 255, 0.92);
      text-transform: uppercase;
      max-width: 28ch;
      white-space: pre-line;
    }
    @media (max-width: 900px) {
      .bp-inner {
        grid-template-columns: 1fr;
      }
      .bp-bio {
        max-width: 34ch;
      }
    }
  </style>
</section>
